{"ast":null,"code":"/*! @azure/msal-common v4.3.0 2021-05-12 */\n'use strict';\n\nimport { StringUtils } from '../utils/StringUtils.js';\nimport { ClientConfigurationError } from '../error/ClientConfigurationError.js';\nimport { PromptValue, CodeChallengeMethodValues } from '../utils/Constants.js';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\n/**\r\n * Validates server consumable params from the \"request\" objects\r\n */\n\nvar RequestValidator =\n/** @class */\nfunction () {\n  function RequestValidator() {}\n  /**\r\n   * Utility to check if the `redirectUri` in the request is a non-null value\r\n   * @param redirectUri\r\n   */\n\n\n  RequestValidator.validateRedirectUri = function (redirectUri) {\n    if (StringUtils.isEmpty(redirectUri)) {\n      throw ClientConfigurationError.createRedirectUriEmptyError();\n    }\n  };\n  /**\r\n   * Utility to validate prompt sent by the user in the request\r\n   * @param prompt\r\n   */\n\n\n  RequestValidator.validatePrompt = function (prompt) {\n    if ([PromptValue.LOGIN, PromptValue.SELECT_ACCOUNT, PromptValue.CONSENT, PromptValue.NONE].indexOf(prompt) < 0) {\n      throw ClientConfigurationError.createInvalidPromptError(prompt);\n    }\n  };\n\n  RequestValidator.validateClaims = function (claims) {\n    try {\n      JSON.parse(claims);\n    } catch (e) {\n      throw ClientConfigurationError.createInvalidClaimsRequestError();\n    }\n  };\n  /**\r\n   * Utility to validate code_challenge and code_challenge_method\r\n   * @param codeChallenge\r\n   * @param codeChallengeMethod\r\n   */\n\n\n  RequestValidator.validateCodeChallengeParams = function (codeChallenge, codeChallengeMethod) {\n    if (StringUtils.isEmpty(codeChallenge) || StringUtils.isEmpty(codeChallengeMethod)) {\n      throw ClientConfigurationError.createInvalidCodeChallengeParamsError();\n    } else {\n      this.validateCodeChallengeMethod(codeChallengeMethod);\n    }\n  };\n  /**\r\n   * Utility to validate code_challenge_method\r\n   * @param codeChallengeMethod\r\n   */\n\n\n  RequestValidator.validateCodeChallengeMethod = function (codeChallengeMethod) {\n    if ([CodeChallengeMethodValues.PLAIN, CodeChallengeMethodValues.S256].indexOf(codeChallengeMethod) < 0) {\n      throw ClientConfigurationError.createInvalidCodeChallengeMethodError();\n    }\n  };\n  /**\r\n   * Removes unnecessary or duplicate query parameters from extraQueryParameters\r\n   * @param request\r\n   */\n\n\n  RequestValidator.sanitizeEQParams = function (eQParams, queryParams) {\n    if (!eQParams) {\n      return {};\n    } // Remove any query parameters already included in SSO params\n\n\n    queryParams.forEach(function (value, key) {\n      if (eQParams[key]) {\n        delete eQParams[key];\n      }\n    });\n    return eQParams;\n  };\n\n  return RequestValidator;\n}();\n\nexport { RequestValidator };","map":{"version":3,"sources":["../../src/request/RequestValidator.ts"],"names":[],"mappings":";;;;;;AAAA;;;;;AAUA;;;;;;;AAGA,WAAA,gBAAA,GAAA,CAmFC;;;;;;;AA7EU,EAAA,gBAAA,CAAA,mBAAA,GAAP,UAA2B,WAA3B,EAA8C;AAC1C,QAAI,WAAW,CAAC,OAAZ,CAAoB,WAApB,CAAJ,EAAsC;AAClC,YAAM,wBAAwB,CAAC,2BAAzB,EAAN;AACH;AACJ,GAJM;;;;;;;AAUA,EAAA,gBAAA,CAAA,cAAA,GAAP,UAAsB,MAAtB,EAAoC;AAChC,QACI,CACI,WAAW,CAAC,KADhB,EAEI,WAAW,CAAC,cAFhB,EAGI,WAAW,CAAC,OAHhB,EAII,WAAW,CAAC,IAJhB,EAKE,OALF,CAKU,MALV,IAKoB,CANxB,EAOE;AACE,YAAM,wBAAwB,CAAC,wBAAzB,CAAkD,MAAlD,CAAN;AACH;AACJ,GAXM;;AAaA,EAAA,gBAAA,CAAA,cAAA,GAAP,UAAsB,MAAtB,EAAoC;AAChC,QAAI;AACA,MAAA,IAAI,CAAC,KAAL,CAAW,MAAX;AACH,KAFD,CAEE,OAAM,CAAN,EAAS;AACP,YAAM,wBAAwB,CAAC,+BAAzB,EAAN;AACH;AACJ,GANM;;;;;;;;AAaA,EAAA,gBAAA,CAAA,2BAAA,GAAP,UAAmC,aAAnC,EAA0D,mBAA1D,EAAqF;AACjF,QAAI,WAAW,CAAC,OAAZ,CAAoB,aAApB,KAAsC,WAAW,CAAC,OAAZ,CAAoB,mBAApB,CAA1C,EAAoF;AAChF,YAAM,wBAAwB,CAAC,qCAAzB,EAAN;AACH,KAFD,MAEO;AACH,WAAK,2BAAL,CAAiC,mBAAjC;AACH;AACJ,GANM;;;;;;;AAYA,EAAA,gBAAA,CAAA,2BAAA,GAAP,UAAmC,mBAAnC,EAA8D;AAC1D,QACI,CACI,yBAAyB,CAAC,KAD9B,EAEI,yBAAyB,CAAC,IAF9B,EAGE,OAHF,CAGU,mBAHV,IAGiC,CAJrC,EAKE;AACE,YAAM,wBAAwB,CAAC,qCAAzB,EAAN;AACH;AACJ,GATM;;;;;;;AAeA,EAAA,gBAAA,CAAA,gBAAA,GAAP,UAAwB,QAAxB,EAA8C,WAA9C,EAA8E;AAC1E,QAAI,CAAC,QAAL,EAAe;AACX,aAAO,EAAP;AACH,KAHyE,C;;;AAM1E,IAAA,WAAW,CAAC,OAAZ,CAAoB,UAAC,KAAD,EAAQ,GAAR,EAAW;AAC3B,UAAI,QAAQ,CAAC,GAAD,CAAZ,EAAmB;AACf,eAAO,QAAQ,CAAC,GAAD,CAAf;AACH;AACJ,KAJD;AAMA,WAAO,QAAP;AACH,GAbM;;AAcX,SAAA,gBAAA;AAAC,C","sourcesContent":["/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { StringUtils } from \"../utils/StringUtils\";\r\nimport { ClientConfigurationError } from \"../error/ClientConfigurationError\";\r\nimport { PromptValue, CodeChallengeMethodValues} from \"../utils/Constants\";\r\nimport { StringDict } from \"../utils/MsalTypes\";\r\n\r\n/**\r\n * Validates server consumable params from the \"request\" objects\r\n */\r\nexport class RequestValidator {\r\n\r\n    /**\r\n     * Utility to check if the `redirectUri` in the request is a non-null value\r\n     * @param redirectUri\r\n     */\r\n    static validateRedirectUri(redirectUri: string) : void {\r\n        if (StringUtils.isEmpty(redirectUri)) {\r\n            throw ClientConfigurationError.createRedirectUriEmptyError();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Utility to validate prompt sent by the user in the request\r\n     * @param prompt\r\n     */\r\n    static validatePrompt(prompt: string) : void {\r\n        if (\r\n            [\r\n                PromptValue.LOGIN,\r\n                PromptValue.SELECT_ACCOUNT,\r\n                PromptValue.CONSENT,\r\n                PromptValue.NONE\r\n            ].indexOf(prompt) < 0\r\n        ) {\r\n            throw ClientConfigurationError.createInvalidPromptError(prompt);\r\n        }\r\n    }\r\n\r\n    static validateClaims(claims: string) : void {\r\n        try {\r\n            JSON.parse(claims);\r\n        } catch(e) {\r\n            throw ClientConfigurationError.createInvalidClaimsRequestError();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Utility to validate code_challenge and code_challenge_method\r\n     * @param codeChallenge\r\n     * @param codeChallengeMethod\r\n     */\r\n    static validateCodeChallengeParams(codeChallenge: string, codeChallengeMethod: string) : void  {\r\n        if (StringUtils.isEmpty(codeChallenge) || StringUtils.isEmpty(codeChallengeMethod)) {\r\n            throw ClientConfigurationError.createInvalidCodeChallengeParamsError();\r\n        } else {\r\n            this.validateCodeChallengeMethod(codeChallengeMethod);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Utility to validate code_challenge_method\r\n     * @param codeChallengeMethod\r\n     */\r\n    static validateCodeChallengeMethod(codeChallengeMethod: string) : void {\r\n        if (\r\n            [\r\n                CodeChallengeMethodValues.PLAIN,\r\n                CodeChallengeMethodValues.S256\r\n            ].indexOf(codeChallengeMethod) < 0\r\n        ) {\r\n            throw ClientConfigurationError.createInvalidCodeChallengeMethodError();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes unnecessary or duplicate query parameters from extraQueryParameters\r\n     * @param request\r\n     */\r\n    static sanitizeEQParams(eQParams: StringDict, queryParams: Map<string, string>) : StringDict {\r\n        if (!eQParams) {\r\n            return {};\r\n        }\r\n\r\n        // Remove any query parameters already included in SSO params\r\n        queryParams.forEach((value, key) => {\r\n            if (eQParams[key]) {\r\n                delete eQParams[key];\r\n            }\r\n        });\r\n\r\n        return eQParams;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}